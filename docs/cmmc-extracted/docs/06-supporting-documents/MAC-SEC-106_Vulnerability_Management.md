# Vulnerability Management - CMMC Level 1

**Document Version:** 1.0  
**Date:** 2026-01-21  
**Classification:** Internal Use  
**Compliance Framework:** CMMC 2.0 Level 1 (Foundational)  
**Reference:** FAR 52.204-21

**Applies to:** CMMC 2.0 Level 1 (FCI-only system)

---

## Purpose

This document describes the vulnerability management workflow for identifying, reporting, and correcting information system flaws. This process ensures timely remediation of security vulnerabilities in application dependencies and system components.

---

## Dependency Update Workflow

### 1. Vulnerability Identification

**Method 1: npm audit**
```bash
npm audit
```

**Output:** List of vulnerabilities with severity levels (low, moderate, high, critical)

**Frequency:** Weekly or before each deployment

**Evidence:** Save audit output to file
```bash
npm audit > audit-report-$(date +%Y%m%d).txt
```

---

**Method 2: Dependabot (GitHub)**

If using GitHub, Dependabot automatically:
- Scans dependencies weekly
- Creates pull requests for security updates
- Alerts for high/critical severity vulnerabilities

**Configuration:** `.github/dependabot.yml`

**Evidence:** Dependabot pull requests and alerts in GitHub

---

**Method 3: Manual Review**

- Monitor security advisories for key dependencies
- Review release notes for security patches
- Check CVE databases for known vulnerabilities

**Dependencies to Monitor:**
- Next.js
- NextAuth.js
- Prisma
- React
- Node.js runtime

---

### 2. Vulnerability Assessment

**Severity Levels:**
- **Critical:** Immediate action required
- **High:** Address within 1 week
- **Medium:** Address within 1 month
- **Low:** Address in next update cycle

**Assessment Criteria:**
- Does vulnerability affect production code paths?
- Is vulnerable dependency actually used?
- What is the exploitability?
- What is the impact if exploited?

---

### 3. Remediation Process

**Step 1: Identify Fix**
- Check if update available
- Review changelog for breaking changes
- Test update in development environment

**Step 2: Update Dependency**
```bash
# Update specific package
npm update package-name

# Or update all packages
npm update

# For major version updates
npm install package-name@latest
```

**Step 3: Test Application**
- Run test suite
- Manual testing of affected features
- Verify no breaking changes

**Step 4: Update package.json**
- Commit updated `package.json` and `package-lock.json`
- Document update in commit message

**Step 5: Deploy**
- Deploy to production
- Verify application functions correctly
- Monitor for issues

---

### 4. Evidence Capture

**For npm audit:**
1. Run `npm audit`
2. Save output to file: `audit-report-YYYYMMDD.txt`
3. Store in compliance evidence folder

**For Dependabot (GitHub):**
1. Screenshot Dependabot alerts
2. Export pull request list
3. Document remediation actions

**For Manual Updates:**
1. Document vulnerability identified
2. Document remediation action taken
3. Record update date and version
4. Store in compliance evidence

---

## Vulnerability Scanning

### Automated Scanning

**Dependabot Configuration:** `.github/dependabot.yml`

**Process:**
1. Dependabot runs weekly scans of npm dependencies
2. Creates pull requests for security updates
3. Groups security updates together
4. Organization reviews and merges updates

### Manual Scanning

**npm audit:**
- Run `npm audit` manually to identify vulnerabilities
- Review and remediate findings
- Document remediation in vulnerability remediation logs

**Evidence:** CI/CD logs, audit reports

---

### Dependabot Configuration

**File:** `.github/dependabot.yml`

**Configuration:**
- Weekly dependency updates
- Security updates prioritized
- Automatic pull requests

**Evidence:** Dependabot pull requests, GitHub alerts

---

## Remediation Timeline

**Critical Vulnerabilities:**
- Assessment: Within 24 hours
- Remediation: Within 48 hours (or as soon as patch available)

**High Severity:**
- Assessment: Within 1 week
- Remediation: Within 2 weeks

**Medium Severity:**
- Assessment: Within 1 month
- Remediation: Within 2 months

**Low Severity:**
- Assessment: Next update cycle
- Remediation: Next update cycle

---

## How to Produce Evidence

### For npm audit:

1. **Run audit:**
   ```bash
   npm audit
   ```

2. **Save report:**
   ```bash
   npm audit > compliance/evidence/audit-report-$(date +%Y%m%d).txt
   ```

3. **Review and document:**
   - Note any high/critical vulnerabilities
   - Document remediation plan
   - Track remediation status

### For Dependabot:

1. **GitHub Dashboard:**
   - Navigate to Security → Dependabot alerts
   - Screenshot alerts page
   - Export alert list

2. **Pull Requests:**
   - List Dependabot PRs
   - Show merged security updates
   - Document update dates

### For CI/CD:

1. **GitHub Actions:**
   - Navigate to Actions tab
   - View security-audit workflow runs
   - Download audit report artifacts
   - Screenshot workflow results

---

## Example Evidence

### npm audit Output

```
# npm audit report saved to: audit-report-20250121.txt

# Sample output:
found 0 vulnerabilities
```

Or if vulnerabilities found:
```
found 3 vulnerabilities (1 moderate, 2 high)
  run `npm audit fix` to fix them, or `npm audit` for details
```

### Remediation Log

| Date | Package | Version (Old → New) | Severity | Status |
|------|---------|---------------------|----------|--------|
| 2026-01-15 | package-name | 1.0.0 → 1.0.1 | High | Fixed |
| 2026-01-20 | another-package | 2.1.0 → 2.1.2 | Medium | Fixed |

---

**Document Status:** This document reflects the system state as of 2026-01-21 and is maintained under configuration control.

---

## Document Control

**Prepared By:** MacTech Solutions Compliance Team  
**Reviewed By:** ________________________  
**Approved By:** ________________________  
**Next Review Date:** ________________________  
*(Complete at document approval.)*

**Change History:**
- Version 1.0 (2026-01-21): Initial document creation

---

## Appendix A: Related Documents

- Evidence Index (`../05-evidence/MAC-RPT-100_Evidence_Index.md`)
- Internal Audit Checklist (`../04-self-assessment/MAC-AUD-103_Internal_Audit_Checklist.md`)

## Appendix B: Useful Commands

```bash
# Full audit with JSON output
npm audit --json > audit-json-$(date +%Y%m%d).json

# Audit fix (automatic updates)
npm audit fix

# Check for outdated packages
npm outdated

# Update all packages to latest (careful - may have breaking changes)
npm update
```
